<nav aria-label="breadcrumb" *ngIf="loanDetails">
    <ol class="breadcrumb pl-0">
        <li class="breadcrumb-item"><a [routerLink]="['/home/client/view',loanDetails.clientId]" [routerLinkActive]="['active']">{{loanDetails.clientName}}</a></li>
        <li class="breadcrumb-item active">{{loanDetails.loanProductName}}({{loanDetails.accountNo}})</li>
    </ol>
</nav>
<div class="col-12 col-xxl row m-0 p-0" *ngIf="loanDetails">
    <div class="card mb-3" style="width: 100%; background-color:#5b6268">
        <div class="card-header-banner">
            <h2 class="ml-5 mt-4 mb-4 text-white">
                <i *ngIf="!loanDetails.inArrears" class="fa fa-stop {{loanDetails.status.code | StatusLookup}}"></i>
                <i *ngIf="loanDetails.inArrears" class="icon-stop {{loanDetails.status.code | StatusLookup}}overdue"></i> {{loanDetails.loanProductName}}(#{{loanDetails.accountNo}})
                <span *ngIf="loanDetails.status.closed || loanDetails.status.deathOfApplicant">- {{loanDetails.status.value}}</span>
            </h2>
        </div>
        <div class="card-body">
            <div class="row ml-4 mb-4 mr-4">
                <span class="ml-auto">
                <span *ngIf="showGenerateNocButton">
                    <button class="btn btn-primary mr-2 mb-2" *hasPermission="'UPDATE_NOCFORLOAN'">Generate NOC
                    </button>
                </span>
                <!-- Generate NOC method on click-->
                <span *ngIf="loanDetails.status.deathOfApplicant || loanDetails.status.deathOfCoApplicant">
                    <button class="btn btn-primary" *hasPermission="'FORECLOSE_DECEASED_CLIENT'">Foreclosure</button>
                </span>
                <!-- Foreclosure event on click -->
                <span *ngIf="loanDetails.status.deathOfApplicant  ||  loanDetails.status.deathOfCoApplicant  || loanDetails.status.deathForeclosureFreeze ||loanDetails.status.deathCoApplicantForeclosureFreeze">
                    <button class="btn btn-primary" *hasPermission="'VIEW_FORECLOSURE_LOAN'">View Foreclosure</button>
                </span>
                <!-- View Foreclosure event on click -->
                <span *ngFor="let button of buttons.singlebuttons" class="">
                    <span *ngIf="button.name" >
                        <button class="btn btn-primary mr-2 mb-2" [disabled]="isRepaid(button.name) || undoDisbursalCheck(button.name)" *hasPermission="button.taskPermissionName">
                            <i class="{{button.icon}} text-white"></i>
                        {{button.name}}
                        </button>
                        <!-- bind click event -->
                    </span>
                </span>
                <span>
                    <button class="btn btn-primary dropdown-toggle mr-2 mb-2" *ngIf="buttons.options || isOverpaidExists || !hideButtonOptions" data-toggle="dropdown">More</button>
                    <div class="dropdown-menu dropdown-menu">
                        <div *ngFor="let btn of buttons.options">
                            <a class="dropdown-item" type="button" *hasPermission="btn.taskPermissionName">
                                <!-- Add click event -->
                                {{btn.name}}
                            </a>
                        </div>
                        <div *ngIf="loanDetails.status.active">
                            <!-- Add click event --> 
                            <a class="dropdown-item" type="button" *hasPermission="'CREATE_FORECLOSURE'">
                            ForeClosure</a> 
                        </div>
                        <div *ngIf="loanDetails.status.active || loanDetails.status.freezedForForeClosure"> 
                            <!-- Add click event --> 
                            <a class="dropdown-item" type="button" *hasPermission="'VIEW_FORECLOSURE_LOAN'"> Foreclosure(View Only)</a>
                        </div>
                        <div *ngIf="(loanDetails.status.pendingApproval || loanDetails.status.waitingForDisbursal || loanDetails.status.active) && loanAppRefData?.coApplicant1Id"> 
                            <!-- Add href link --> 
                            <a class="dropdown-item" type="button" *hasPermission="'COAPPLICANTDEATH_CLIENT'">
                            Close(Death Of Co-Applicant)</a> 
                        </div>
                        <div *ngIf="showCaptureAccountGstExemption"> 
                            <!-- Add href link --> 
                            <a class="dropdown-item" type="button" *hasPermission="'UPDATE_GST_NUMBER'">Capture Account GST Details</a> 
                        </div>
                        <div *ngIf="isOverpaidExists"> 
                            <!-- Add click event --> 
                            <a class="dropdown-item" type="button" *hasPermission="'OVERPAIDLOANCLOSURE_LOAN'">Post maturity overpaid closure</a> 
                        </div>
                    </div>
                </span>
                </span>
            </div>
            <div class="row col-sm-12">
                <div class="col-sm-6">
                    <div class="row col-sm-12 mb-3">
                        <div class="col-sm-6 detail-key">DisbursementDate</div>
                        <div class="col-sm-6 text-white">{{(loanDetails.timeline.actualDisbursementDate | date: dateFormat) || 'Not Available'}}
                        </div>
                    </div>

                    <div class="row col-sm-12 mb-3">
                        <div class="col-sm-6 detail-key">Currency</div>
                        <div class="col-sm-6 text-white ">{{loanDetails.currency.name}}</div>
                    </div>

                    <div class="row col-sm-12 mb-3">
                        <div class="col-sm-6 detail-key">Loan Officer</div>
                        <div class="col-sm-6 text-white">{{loanDetails.loanOfficerName || 'Unassigned'}}
                            <span *ngIf="loanDetails.loanOfficerName" class="ml-2">
                                <a type="button">
                                    <i class="fa fa-remove"></i>
                                </a>
                            </span>
                        </div>
                    </div>

                    <div class="row col-sm-12 mb-3">
                        <div class="col-sm-6 detail-key">External Id</div>
                        <div class="col-sm-6 text-white">{{loanDetails.externalId}}</div>
                    </div>

                    <div class="row col-sm-12 mb-3" *ngIf="loanDetails.loanClassificationData?.classification">
                        <div class="col-sm-6 detail-key">Loan Asset Classification Type </div>
                        <div class="col-sm-6 text-white">{{loanDetails.loanClassificationData.classification.value}}</div>
                    </div>

                    <div class="row col-sm-12 mb-3" *ngIf="loanAppRefData">
                        <div class="col-sm-6 detail-key">Application Ref No </div>
                        <div class="col-sm-6 text-white">{{loanAppRefData.applicationReferenceNo}}</div>
                    </div>

                    <div class="row col-sm-12 mb-3" *ngIf="loanAppRefData?.coApplicant1Name">
                        <div class="col-sm-6 detail-key">CoApplicant </div>
                        <div class="col-sm-6 text-white">{{loanAppRefData.coApplicant1Name}}</div>
                    </div>

                    <div class="row col-sm-12 mb-3" *ngIf="loanAppRefData?.coapplicantLeadid">
                        <div class="col-sm-6 detail-key">CoApplicant Lead Id </div>
                        <div class="col-sm-6 text-white">{{loanAppRefData.coapplicantLeadid}}</div>
                    </div>
                    <div class="row col-sm-12 mb-3" *ngIf="loanDetails.foreclosureReason">
                        <div class="col-sm-6 detail-key">Foreclosure Reason </div>
                        <div class="col-sm-6 text-white">{{loanDetails.foreclosureReason.label}}</div>
                    </div>

                    <div class="row col-sm-12 mb-3">
                        <div class="col-sm-6 detail-key">Is Loan in NPA Status </div>
                        <div class="col-sm-6 text-white">{{loanDetails.isNPA ? "Yes" : "No"}}</div>
                    </div>

                    <div *ngIf="loanDetails?.assetClassification" class="row col-sm-12 mb-3">
                        <div class="col-sm-6 detail-key">Interface Asset Classification Type</div>
                        <div class="col-sm-6 text-white">{{loanDetails.assetClassification}}</div>
                    </div>
                    <div class="row col-sm-12 mb-3">
                        <div class="col-sm-6 detail-key">Rescheduled due to moratorium </div>
                        <div class="col-sm-6 text-white">{{rescheduledByMoratorium ? "Yes" : "No"}}</div>
                    </div>

                </div>
                <div class="col-sm-6">
                    <!-- TODO -->
                    <!-- <div class="row col-sm-12 mb-3">
                        <div class="col-sm-6 detail-key">E-Signed Documents</div>
                        <div class="col-sm-6 text-white">{{loanDetails.loanOfficerName}}</div>
                    </div> -->
                    <div class="row col-sm-12 mb-3">
                        <div class="col-sm-6 detail-key">Loan Purpose </div>
                        <div class="col-sm-6 text-white">{{loanDetails.loanPurposeName || 'Not Provided'}}</div>
                    </div>

                    <div class="row col-sm-12 mb-3">
                        <div class="col-sm-6 detail-key">Approved Amount </div>
                        <div class="col-sm-6 text-white">{{loanDetails.approvedPrincipal | number}}</div>
                    </div>

                    <div class="row col-sm-12 mb-3">
                        <div class="col-sm-6 detail-key">Disbursed Amount </div>
                        <div class="col-sm-6 text-white">{{loanDetails.principal | number}}</div>
                    </div>

                    <div class="row col-sm-12 mb-3">
                        <div class="col-sm-6 detail-key">Net Outflow Amount </div>
                        <div class="col-sm-6 text-white">{{loanDetails.netDisbursementAmount | number}}</div>
                    </div>

                    <div class="row col-sm-12 mb-3">
                        <div class="col-sm-6 detail-key">Arrears By </div>
                        <div class="col-sm-6 text-white">{{loanDetails.summary?.totalOverdue >= 0 ? loanDetails.summary?.totalOverdue : 'Not Provided'}}</div>
                    </div>

                    <div class="row col-sm-12 mb-3">
                        <div class="col-sm-6 detail-key">Days Past Due </div>
                        <div class="col-sm-6 text-white">{{loanDetails.summary?.daysPastDue}}</div>
                    </div>

                    <div class="row col-sm-12 mb-3">
                        <div class="col-sm-6 detail-key">Total Advance Paid </div>
                        <div class="col-sm-6 text-white">{{loanDetails.summary?.totalAdvancePaid >= 0 ? loanDetails.summary?.totalAdvancePaid :'Not Provided'}}</div>
                    </div>

                    <div class="row col-sm-12 mb-3" *ngIf="isOverpaidExists">
                        <div class="col-sm-6 detail-key">Total Overpaid Amount</div>
                        <div class="col-sm-6 text-white">{{loanDetails.totalOverpaid}}</div>
                    </div>

                    <div class="row col-sm-12 mb-3">
                        <div class="col-sm-6 detail-key">Roundoff Amount </div>
                        <div class="col-sm-6 text-white">{{loanDetails.summary?.roundoffAmount}}</div>
                    </div>

                    <div class="row col-sm-12 mb-3">
                        <div class="col-sm-6 detail-key">Total RSD Amount </div>
                        <div class="col-sm-6 text-white">{{rsdTransactions?.amount}}</div>
                    </div>
                </div>
            </div>
        </div>
        <ul class="nav nav-tabs bg-white">
            <li class="nav-item">
                <a href="" class="nav-link active" data-toggle="tab" (click)="setTab(1)">Account Details</a>
            </li>
            <li class=" nav-item " *ngIf="loanDetails.guarantors">
                <a href="" class="nav-link " data-toggle="tab" (click)="setTab(2)">Loan witnesses</a>
            </li>
            <li class=" nav-item " *ngIf="loanDetails.summary">
                <a href="" class="nav-link " data-toggle="tab" (click)="setTab(3)">Summary</a>
            </li>
            <li class=" nav-item " *ngIf="loanDetails.originalSchedule">
                <a href="" class="nav-link " data-toggle="tab" (click)="setTab(4)">Original Schedule</a>
            </li>
            <li class=" nav-item ">
                <a href="" class="nav-link " data-toggle="tab" (click)="setTab(5)">Repayment Schedule</a>
            </li>
            <li class=" nav-item " *ngIf="loanDetails.repaymentSchedule.futurePeriods">
                <a href="" class="nav-link " data-toggle="tab" (click)="setTab(6)">Future Schedule</a>
            </li>
            <li class="nav-item " *ngIf="loanDetails.transactions">
                <a href="" class="nav-link " data-toggle="tab" (click)="setTab(7)">Transactions</a>
            </li>
            <li class=" nav-item ">
                <a href="" class="nav-link " data-toggle="tab" (click)="setTab(8)">Charges</a>
            </li>
            <li class="nav-item ">
                <a href=" " class="nav-link " data-toggle="tab" (click)="setTab(9)">Loan Documents</a>
            </li>
            <li class="nav-item">
                <a href="" class="nav-link " data-toggle="tab" (click)="setTab(10)">Assets</a>
            </li>
            <li class="nav-item">
                <a href="" class="nav-link " data-toggle="tab" (click)="setTab(10)">Bank Accounts</a>
            </li>
            <li class="nav-item">
                <a href="" class="nav-link " data-toggle="tab" (click)="setTab(11)">Business Expenses</a>
            </li>
            <li class="nav-item">
                <a href="" class="nav-link " data-toggle="tab" (click)="setTab(12)">Cam Approver Details</a>
            </li>
            <li class="nav-item">
                <a href="" class="nav-link " data-toggle="tab" (click)="setTab(13)">Change Log</a>
            </li>
            <li class="nav-item">
                <a href="" class="nav-link " data-toggle="tab" (click)="setTab(14)">Deviation Rules</a>
            </li>
            <li class="nav-item">
                <a href="" class="nav-link " data-toggle="tab" (click)="setTab(15)">Eligibility Rules</a>
            </li>
            <li class="nav-item">
                <a href="" class="nav-link " data-toggle="tab" (click)="setTab(16)">d_eligibility_rules_history</a>
            </li>
            <li class="nav-item">
                <a href="" class="nav-link " data-toggle="tab" (click)="setTab(17)">Existing Loan</a>
            </li>
            <li class="nav-item">
                <a href="" class="nav-link " data-toggle="tab" (click)="setTab(18)">FATCA</a>
            </li>
            <li class="nav-item">
                <a href="" class="nav-link " data-toggle="tab" (click)="setTab(19)">Household Expenses</a>
            </li>
            <li class="nav-item">
                <a href="" class="nav-link " data-toggle="tab" (click)="setTab(20)">Household Income</a>
            </li>
            <li class="nav-item">
                <a href="" class="nav-link " data-toggle="tab" (click)="setTab(21)">Nominee Details</a>
            </li>
            <li class="nav-item">
                <a href="" class="nav-link " data-toggle="tab" (click)="setTab(22)">Personal Details</a>
            </li>
            <li class="nav-item">
                <a href="" class="nav-link " data-toggle="tab" (click)="setTab(23)">End Use Check</a>
            </li>

        </ul>
    </div>
    <div class="card pr-4 pl-4" style="width:inherit;">
        <div [ngSwitch]="tab ">
            <div *ngSwitchCase="1">
                <div class="card-body" id="border">
                    <div class="pt-3 pb-3">
                        <div class="row col-sm-12 pt-3 pb-3">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Repayment Strategy</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">
                                {{loanDetails.transactionProcessingStrategyName}}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Repayments</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.numberOfRepayments}} Repayments, Repay Every {{loanDetails.repaymentEvery}} {{loanDetails.repaymentFrequencyType.value}}
                            </div>
                        </div>

                        <div class="row col-sm-12 pt-3 pb-3">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Amortization</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.amortizationType.value}}
                            </div>
                        </div>

                        <div class="row col-sm-12 pt-3 pb-3">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Interest</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.annualInterestRate}}% per annum - {{loanDetails.interestType.value}}
                            </div>
                        </div>

                        <div class="row col-sm-12 pt-3 pb-3" *ngIf="loanDetails.discountPercentageOnInterest">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Promo Code Interest Discount</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.discountPercentageOnInterest}}%
                            </div>
                        </div>

                        <div class="row col-sm-12 pt-3 pb-3" *ngIf="loanDetails.discountFeePercentageOrAmount">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Promo Code Fee Discount</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.discountFeePercentageOrAmount}}
                            </div>
                        </div>

                        <div class="row col-sm-12 pt-3 pb-3">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Grace: On Principal Payment</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.graceOnPrincipalPayment}}
                            </div>
                        </div>

                        <div class="row col-sm-12 pt-3 pb-3">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Grace: On Interest Payment</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.graceOnInterestPayment}}
                            </div>
                        </div>

                        <div class="row col-sm-12 pt-3 pb-3">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Grace on Arrears Ageing</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.graceOnArrearsAgeing}}
                            </div>
                        </div>

                        <div class="row col-sm-12 pt-3 pb-3">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Fund Source</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.fundName}}
                            </div>
                        </div>

                        <div class="row col-sm-12 pt-3 pb-3">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Interest Free Period</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.graceOnInterestCharged}}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Interest Calculation Period</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.interestCalculationPeriodType.value}}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Interest Type</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.interestType.value}}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Submitted On</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.timeline.submittedOnDate | date : dateFormat}}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Approved On</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.timeline.approvedOnDate | date : dateFormat}}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Disbursed On</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.timeline.actualDisbursementDate | date : dateFormat}}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Matures on</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.timeline.expectedMaturityDate | date : dateFormat}}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Closed On</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.timeline.closedOnDate | date : dateFormat}}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3" *ngIf="loanDetails.canDefineInstalmentAmount">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Installment Amount</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.fixedEmiAmount| number}}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Recalculate Interest</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.isInterestRecalculationEnabled ? "Yes" : "No"}}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Days in Year</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.daysInYearType.value}}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Days in Month</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.daysInMonthType.value}}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">RSD Product</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{ rsdAccountData[0]?.regularSavingsDeposit.productName }}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">RSD Amount</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{ rsdAccountData[0]?.rsdAmount }}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">RSD/CBS Account number</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{ rsdAccountData[0]?.cbsAccountId }}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3" *ngIf="loanDetails.isInterestRecalculationEnabled">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Interest recalculation compounding on</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.interestRecalculationData.interestRecalculationCompoundingType.value}}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3" *ngIf="loanDetails.isInterestRecalculationEnabled">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Advance payments adjustment type</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.interestRecalculationData.rescheduleStrategyType.value}}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3" *ngIf="loanDetails.isInterestRecalculationEnabled">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Frequency for recalculate Outstanding Principal</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.interestRecalculationData.calendarData.humanReadable}}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3" *ngIf="loanDetails.debitFreezeFlag">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Interface debit freeze flag</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.debitFreezeFlag}}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3" *ngIf="loanDetails.provisionAmount >= 0">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Interface provision amount</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.provisionAmount}}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3" *ngIf="loanDetails.writeOffAmt >= 0">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Interface writeoff amount</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.writeOffAmt}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3" *ngIf="loanDetails.writeOffDate">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Interface writeoff date</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.writeOffDate | date : dateFormat}}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3" *ngIf="loanDetails.incomeTreatmentFlag">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Interface income treatment flag</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.incomeTreatmentFlag}}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3" *ngIf="loanDetails.npaEffectiveDate">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Interface NPA effective date</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.npaEffectiveDate | date : dateFormat}}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3" *ngIf="loanDetails.nomineeClaimAmount >= 0">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Nominee Claim Amount</h6>
                            </div>
                            <div class="col-sm-8 text-secondary">{{loanDetails.nomineeClaimAmount}}
                            </div>
                        </div>
                        <div class="row col-sm-12 pt-3 pb-3" *ngIf="loanDetails.nomineeClaimAmount >= 0">
                            <div class="col-sm-4 p-0">
                                <h6 class="mb-0">Subvention Scheme</h6>
                            </div>
                            <div class="col-sm-8 text-secondary"><span *ngFor="let schemeId in loandetails.schemeIds;last as last">{{schemeId}}<span ng-repeat-end ng-if="!$last">&nbsp;, </span> </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div *ngSwitchCase="2">
                <div class="card mt-4 mb-4">
                    <div class="card-content">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>First Name</th>
                                    <th>Last Name</th>
                                    <th>Relationship</th>
                                    <th>Guarantor Type</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <ng-container *ngFor="let guarantor of loanDetails.guarantors; index as i">
                                    <tr>
                                        <td>{{guarantor.firstname}}</td>
                                        <td>{{guarantor.lastname}}</td>
                                        <td>{{guarantor.clientRelationshipType.name}}</td>
                                        <td>{{guarantor.guarantorType.value}}</td>
                                        <td class="h5 mb-0">
                                            <!-- bind link  -->
                                            <i class="fa fa-edit blueText mr-3 pointer" *ngIf="guarantor.guarantorType.id == 3"></i>
                                            <!-- bind click and link  -->
                                            <i class="fa fa-trash required mr-3 pointer" *ngIf="loanDetails.group?.status.value =='Active'"></i>
                                            <i class="blueText pointer" (click)="showGurantorDetails(guarantor.id, i)" [ngClass]="guarantorDetailsTab[i] ? 'fa fa-chevron-circle-up' : 'fa fa-chevron-circle-down'"></i>
                                        </td>
                                    </tr>
                                    <tr *ngIf="guarantorDetails[i] && guarantorDetailsTab[i]">
                                        <td colspan="12" class="p-0">
                                            <div class="card card-body mb-0 no-shadow">
                                                <table class="table mb-0 table-bordered">
                                                    <tr *ngIf="guarantorDetails[i].firstname" class="bg-white">
                                                        <td>First Name</td>
                                                        <td>{{guarantorDetails[i].firstname}}</td>
                                                    </tr>
                                                    <tr *ngIf="guarantorDetails[i].lastname" class="bg-white">
                                                        <td>Last Name</td>
                                                        <td>{{guarantorDetails[i].lastname}}</td>
                                                    </tr>
                                                    <tr *ngIf="guarantorDetails[i].clientRelationshipType.name" class="bg-white">
                                                        <td>Relationship</td>
                                                        <td>{{guarantorDetails[i].clientRelationshipType.name}}</td>
                                                    </tr>
                                                    <tr *ngIf="guarantorDetails[i].guarantorType.value" class="bg-white">
                                                        <td>Guarantor Type</td>
                                                        <td>{{guarantorDetails[i].guarantorType.value}}</td>
                                                    </tr>
                                                    <tr *ngIf="guarantorDetails[i].joinedDate" class="bg-white">
                                                        <td>Join Date</td>
                                                        <td>{{guarantorData[i].joinedDate | date : dateFormat}}</td>
                                                    </tr>
                                                    <tr *ngIf="guarantorDetails[i].officeName" class="bg-white">
                                                        <td>Office</td>
                                                        <td>{{guarantorDetails[i].officeName}}</td>
                                                    </tr>
                                                    <tr *ngIf="guarantorDetails[i].dob" class="bg-white">
                                                        <td>Dob</td>
                                                        <td>{{guarantorDetails[i].dob | date : dateFormat}}</td>
                                                    </tr>
                                                    <tr *ngIf="guarantorDetails[i].mobileNumber" class="bg-white">
                                                        <td>Mobile</td>
                                                        <td>{{guarantorDetails[i].mobileNumber}}</td>
                                                    </tr>
                                                    <tr *ngIf="guarantorDetails[i].housePhoneNumber" class="bg-white">
                                                        <td>Residence</td>
                                                        <td>{{guarantorDetails[i].housePhoneNumber}}</td>
                                                    </tr>
                                                    <tr *ngIf="guarantorDetails[i].city" class="bg-white">
                                                        <td>City</td>
                                                        <td>{{guarantorDetails[i].city}}</td>
                                                    </tr>
                                                </table>
                                            </div>
                                        </td>
                                    </tr>
                                </ng-container>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div *ngSwitchCase="3">
                <div class="card mt-4 mb-4">
                    <div class="card-content">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th></th>
                                    <th>Original</th>
                                    <th>Paid</th>
                                    <th>Waived</th>
                                    <th>Written Off</th>
                                    <th>Outstanding</th>
                                    <th>Over Due</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <th>Principal</th>
                                    <td>{{loanDetails.summary.principalDisbursed | number}}</td>
                                    <td>{{loanDetails.summary.principalPaid | number}}</td>
                                    <td></td>
                                    <td>{{loanDetails.summary.principalWrittenOff | number}}</td>
                                    <td>{{loanDetails.summary.principalOutstanding | number}}</td>
                                    <td>{{loanDetails.summary.principalOverdue | number}}</td>
                                </tr>
                                <tr>
                                    <th>Interest</th>
                                    <td>{{loanDetails.summary.interestCharged | number}}</td>
                                    <td>{{loanDetails.summary.interestPaid | number}}</td>
                                    <td>{{loanDetails.summary.interestWaived | number}}</td>
                                    <td>{{loanDetails.summary.interestWrittenOff | number}}</td>
                                    <td>{{loanDetails.summary.interestOutstanding | number}}</td>
                                    <td>{{loanDetails.summary.interestOverdue | number}}</td>
                                </tr>
                                <tr>
                                    <th>Interest Accrued<span class="required">*</span></th>
                                    <td>{{loanDetails.summary.totalAccruedInterestCharged | number}}</td>
                                    <td>{{loanDetails.summary.totalAccruedInterestPaid | number}}</td>
                                    <td>{{loanDetails.summary.totalAccruedInterestWaived | number}}</td>
                                    <td>{{loanDetails.summary.totalAccruedInterestWrittenOff | number}}</td>
                                    <td>{{loanDetails.summary.totalAccruedInterestOutstanding | number}}</td>
                                    <td>{{loanDetails.summary.totalAccruedInterestOverdue | number}}</td>
                                </tr>
                                <tr>
                                    <th>Fees</th>
                                    <td>{{loanDetails.summary.feeChargesCharged | number}}</td>
                                    <td>{{loanDetails.summary.feeChargesPaid | number}}</td>
                                    <td>{{loanDetails.summary.feeChargesWaived | number}}</td>
                                    <td>{{loanDetails.summary.feeChargesWrittenOff | number}}</td>
                                    <td>{{loanDetails.summary.feeChargesOutstanding | number}}</td>
                                    <td>{{loanDetails.summary.feeChargesOverdue | number}}</td>
                                </tr>
                                <tr>
                                    <th>Penalties</th>
                                    <td>{{loanDetails.summary.penaltyChargesCharged | number}}</td>
                                    <td>{{loanDetails.summary.penaltyChargesPaid | number}}</td>
                                    <td>{{loanDetails.summary.penaltyChargesWaived | number}}</td>
                                    <td>{{loanDetails.summary.penaltyChargesWrittenOff | number}}</td>
                                    <td>{{loanDetails.summary.penaltyChargesOutstanding | number}}</td>
                                    <td>{{loanDetails.summary.penaltyChargesOverdue | number}}</td>
                                </tr>
                                <tr *ngIf="loanDetails.summary.foreClosureFeeCharged">
                                    <th>Foreclosure Charges</th>
                                    <td>{{loanDetails.summary.foreClosureFeeCharged | number}}</td>
                                    <td>{{loanDetails.summary.foreClosureFeePaid | number}}</td>
                                    <td>{{loanDetails.summary.foreClosureFeeWaived | number}}</td>
                                    <td>{{loanDetails.summary.foreClosureFeeWrittenOff | number}}</td>
                                    <td>{{loanDetails.summary.foreClosureFeeOutstaning | number}}</td>
                                    <td>{{0 | number}}</td>
                                </tr>
                                <tr *ngIf="loanDetails.summary.insuranceFeeCharged">
                                    <th>Insurance Premium Amount</th>
                                    <td>{{loanDetails.summary.insuranceFeeCharged | number}}</td>
                                    <td>{{loanDetails.summary.insuranceFeePaid | number}}</td>
                                    <td>{{loanDetails.summary.insuranceFeeWaived | number}}</td>
                                    <td>{{loanDetails.summary.insuranceFeeWrittenOff | number}}</td>
                                    <td>{{loanDetails.summary.insuranceFeeOutstaning | number}}</td>
                                    <td>{{0 | number}}</td>
                                </tr>
                            </tbody>
                            <tfoot>
                                <tr>
                                    <th>Total</th>
                                    <th>{{loanDetails.summary.totalExpectedRepayment | number}}</th>
                                    <th>{{loanDetails.summary.totalRepayment | number}}</th>
                                    <th>{{loanDetails.summary.totalWaived | number}}</th>
                                    <th>{{loanDetails.summary.totalWrittenOff | number}}</th>
                                    <th>{{loanDetails.summary.totalOutstanding | number}}</th>
                                    <th>{{loanDetails.summary.totalOverdue | number}}</th>
                                </tr>
                            </tfoot>
                        </table>
                        <p class="text-danger error ml-2 mb-2">
                            <span class="required mr-1">*</span>Not Included in total
                        </p>
                    </div>
                </div>
            </div>
            <div *ngSwitchCase="4">
                <div class="card mt-4 mb-4">
                    <div class="card-content">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th colspan="1"></th>
                                    <th colspan="2">Loan Amount and Balance</th>
                                    <th colspan="3">Total Cost of Loan</th>
                                    <th colspan="1">Installment Totals</th>
                                </tr>
                                <tr>
                                    <th>Date</th>
                                    <th>Principal Due</th>
                                    <th>Balance of Loan</th>
                                    <th>Interest</th>
                                    <th>Fees</th>
                                    <th>Penalties</th>
                                    <th>Outstanding</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let period in loandetails.originalSchedule.periods">
                                    <td>{{period.dueDate | date : dateFormat}}</td>
                                    <td>{{period.principalDue | number}}</td>
                                    <td>{{period.principalLoanBalanceOutstanding | number}}</td>
                                    <td>{{period.interestOriginalDue | number}}</td>
                                    <td>{{period.feeChargesDue | number}}</td>
                                    <td>{{period.penaltyChargesDue | number}}</td>
                                    <td>{{period.totalOutstandingForPeriod | number}}</td>
                                </tr>
                            </tbody>
                            <tfoot>
                                <tr>
                                    <th>Total</th>
                                    <th>{{loanDetails.originalSchedule.totalPrincipalExpected | number}}</th>
                                    <th></th>
                                    <th>{{loanDetails.originalSchedule.totalInterestCharged | number}}</th>
                                    <th>{{loanDetails.originalSchedule.totalFeeChargesCharged | number}}</th>
                                    <th>{{loanDetails.originalSchedule.totalPenaltyChargesCharged | number}}</th>
                                    <th>{{loanDetails.originalSchedule.totalRepaymentExpected | number}}</th>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>
            <div *ngSwitchCase="5">
                <div class="card mt-4 mb-4">
                    <perfect-scrollbar>
                        <div class="card-content">
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th colspan="5"></th>
                                        <th colspan="2">Loan Amount and Balance</th>
                                        <th colspan="3">Total Cost of Loan</th>
                                        <th colspan="6">Installment Totals</th>
                                    </tr>
                                    <tr>
                                        <th>#</th>
                                        <th>Days</th>
                                        <th>Date</th>
                                        <th>Paid Date</th>
                                        <th>Principal Due</th>
                                        <th>Balance of Loan</th>
                                        <th>Interest Due</th>
                                        <th>Accrued Interest</th>
                                        <th>Fees</th>
                                        <th>Penalties</th>
                                        <th>Installment Amount</th>
                                        <th>Paid</th>
                                        <th>Late</th>
                                        <th *ngIf="loanDetails.repaymentSchedule.totalWaived">Waived</th>
                                        <th>Outstanding</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let period of loanDetails.repaymentSchedule.periods">
                                        <td>{{period.period}}</td>
                                        <td>{{period.daysInPeriod}}</td>
                                        <td>{{period.dueDate | date : dateFormat}}</td>
                                        <td>{{period.obligationsMetOnDate | date : dateFormat}}
                                            <i *ngIf="period.obligationsMetOnDate" class="icon-check icon-white ml-1"></i>
                                        </td>
                                        <td>{{period.principalDue | number}}</td>
                                        <td>{{period.principalLoanBalanceOutstanding | number}}</td>
                                        <td>{{period.interestOriginalDue | number}}</td>
                                        <td>{{period.interestAccrued | number}}</td>
                                        <td>{{period.feeChargesDue | number}}</td>
                                        <td>{{period.penaltyChargesDue | number}}</td>
                                        <td>{{period.totalDueForPeriod | number}}</td>
                                        <td>{{period.totalPaidForPeriod | number}}</td>
                                        <td>{{period.totalPaidLateForPeriod | number}}</td>
                                        <td *ngIf="loanDetails.repaymentSchedule.totalWaived">{{period.totalWaivedForPeriod | number}}</td>
                                        <td>{{period.totalOutstandingForPeriod | number}}</td>
                                    </tr>
                                </tbody>
                                <tfoot>
                                    <tr>
                                        <th></th>
                                        <th>{{loanDetails.repaymentSchedule.loanTermInDays}}</th>
                                        <th>Total</th>
                                        <th></th>
                                        <th>{{loanDetails.repaymentSchedule.totalPrincipalExpected | number}}</th>
                                        <th></th>
                                        <th>{{loanDetails.repaymentSchedule.totalInterestCharged | number}}</th>
                                        <th>{{loanDetails.repaymentSchedule.totalInterestAccrued | number}}</th>
                                        <th>{{loanDetails.repaymentSchedule.totalFeeChargesCharged | number}}</th>
                                        <th>{{loanDetails.repaymentSchedule.totalPenaltyChargesCharged | number}}</th>
                                        <th>{{loanDetails.repaymentSchedule.totalRepaymentExpected | number}}</th>
                                        <th>{{loanDetails.repaymentSchedule.totalRepayment | number}}</th>
                                        <th>{{loanDetails.repaymentSchedule.totalPaidLate | number}}</th>
                                        <th *ngIf="loanDetails.repaymentSchedule.totalWaived">{{loanDetails.repaymentSchedule.totalWaived | number}}</th>
                                        <th>{{loanDetails.repaymentSchedule.totalOutstanding | number}}</th>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </perfect-scrollbar>
                </div>
            </div>
            <div *ngSwitchCase="6">
                <div class="card mt-4 mb-4">
                    <div class="card-content">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th></th>
                                    <th colspan="2">Loan Amount and Balance</th>
                                    <th colspan="3">Total Cost of Loan</th>
                                    <th colspan="1">Installment Totals</th>
                                </tr>
                                <tr>
                                    <th>Date</th>
                                    <th>Principal Due</th>
                                    <th>Balance of Loan</th>
                                    <th>Interest</th>
                                    <th>Fees</th>
                                    <th>Penalties</th>
                                    <th>Outstanding</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let period in loanDetails.repaymentSchedule.futurePeriods">
                                    <td>{{period.dueDate | date : dateFormat}}</td>
                                    <td>{{period.principalDue | number}}</td>
                                    <td>{{period.principalLoanBalanceOutstanding | number}}</td>
                                    <td>{{period.interestOriginalDue | number}}</td>
                                    <td>{{period.feeChargesDue | number}}</td>
                                    <td>{{period.penaltyChargesDue | number}}</td>
                                    <td>{{period.totalOutstandingForPeriod | number}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div *ngSwitchCase="7">
                <div style="text-align: right;" class="mt-4">
                    <input type="checkbox" [(ngModel)]="hideAccruals" class="mr-1">
                    <label class="control-label mr-4">Hide accruals</label>
                    <button class="btn btn-primary" (click)="export()">Export</button>
                </div>
                <div class="card mt-4 mb-4">
                    <div class="card-content">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th class="pointer" (click)="changeTransactionSort('id')">ID</th>
                                    <th class="pointer" (click)="changeTransactionSort('officeName')">Office</th>
                                    <th class="pointer" (click)="changeTransactionSort('date')">Value Date</th>
                                    <th class="pointer" (click)="changeTransactionSort('type.value')">Transaction Type</th>
                                    <th class="pointer" (click)="changeTransactionSort('amount')">Amount</th>
                                    <th class="pointer" (click)="changeTransactionSort('advancepaid')">Advance Payment</th>
                                    <th class="pointer" (click)="changeTransactionSort('totalamount')">Total Amount</th>
                                    <th class="pointer" colspan="4">Breakdown</th>
                                    <th class="pointer">Loan Balance</th>
                                    <th class="pointer">Reversed</th>
                                </tr>
                                <tr>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                    <th class="pointer" (click)="changeTransactionSort('principalPortion')">Principal</th>
                                    <th class="pointer" (click)="changeTransactionSort('interestPortion')">Interest</th>
                                    <th class="pointer" (click)="changeTransactionSort('feeChargesPortion')">Fees</th>
                                    <th class="pointer" (click)="changeTransactionSort('penaltyChargesPortion')">Penalities</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <!-- <tbody>
                                <tr *ngFor="let transaction in loanDetails.transactions | filter:hideAccruals:transaction | orderBy:transactionSort.column:transactionSort.descending" ng-class="'loan-transaction-isreversed-'+transaction.isReversed">
                                    <td class="pointer" data-ng-click="routeTo(loandetails.id,transaction.id,transaction.type.id)"> {{transaction.id}} </td>
                                    <td class="pointer" data-ng-click="routeTo(loandetails.id,transaction.id,transaction.type.id)"> {{transaction.officeName}} </td>
                                    <td class="pointer" data-ng-click="routeTo(loandetails.id,transaction.id,transaction.type.id)"> {{transaction.date | DateFormat}} </td>
                                    <td class="pointer" data-ng-click="routeTo(loandetails.id,transaction.id,transaction.type.id)"> {{transaction.type.value}} </td>
                                    <td class="pointer" data-ng-click="routeTo(loandetails.id,transaction.id,transaction.type.id)"> {{transaction.amount | number}} </td>
                                    <td class="pointer" data-ng-click="routeTo(loandetails.id,transaction.id,transaction.type.id)"> {{transaction.advancePaymentPortion | number}} </td>
                                    <td class="pointer" data-ng-click="routeTo(loandetails.id,transaction.id,transaction.type.id)"> {{transaction.amount + transaction.advancePaymentPortion | number}} </td>
                                    <td class="pointer" data-ng-click="routeTo(loandetails.id,transaction.id,transaction.type.id)"> {{transaction.principalPortion | number}} </td>
                                    <td class="pointer" data-ng-click="routeTo(loandetails.id,transaction.id,transaction.type.id)"> {{transaction.interestPortion | number}} </td>
                                    <td class="pointer" data-ng-click="routeTo(loandetails.id,transaction.id,transaction.type.id)"> {{transaction.feeChargesPortion | number}} </td>
                                    <td class="pointer" data-ng-click="routeTo(loandetails.id,transaction.id,transaction.type.id)"> {{transaction.penaltyChargesPortion | number}} </td>
                                    <td class="pointer" data-ng-click="routeTo(loandetails.id,transaction.id,transaction.type.id)"> {{transaction.outstandingLoanBalance | number}} </td>
                                    <td class="pointer" data-ng-click="routeTo(loandetails.id,transaction.id,transaction.type.id)"> {{transaction.isReversed == true ? "Yes" : "No"}} </td>
                                </tr>
                            </tbody> -->
                        </table>
                    </div>
                </div>
                <!--  -->
            </div>
        </div>
    </div>
</div>